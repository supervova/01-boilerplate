/*
Supports minimal HTML inside bubble: <br>, <b>, <a>

<span class="tooltip-rich">
  <button class="btn" aria-describedby="tt-1">Tooltip trigger</button>
  <span class="tooltip-bubble" id="tt-1" role="tooltip">
    Text with markup<br>
    <b>Note:</b> links are supported â€”
    <a href="#">read more</a>
  </span>
</span>
*/

.tooltip-rich {

  /* It's shared `--tooltip-` vars with .tooltip */

  /* Bubble */
  .tooltip-bubble {
    background-color: var(--tooltip-bg);
    border-radius: var(--radius-sm);
    color: var(--tooltip-color);
    font-size: var(--font-size-fine-print);
    line-height: var(--line-height-fine-print);
    text-transform: none;
    white-space: normal;
    opacity: 0;
    padding: var(--tooltip-padding);
    pointer-events: none;
    position: absolute;
    transition:
      opacity var(--duration-100) var(--easing-base),
      translate var(--duration-100) var(--easing-appearance);
    visibility: hidden;
    width: max-content;
    max-width: var(--tooltip-width);
    z-index: var(--z-tooltip);
  }

  .tooltip-bubble a { color: hsl(var(--h-blue) var(--s-02) 70%); }

  /* Default side: top */
  &:not(.tooltip-right, .tooltip-bottom, .tooltip-left) {
    .tooltip-bubble {
      bottom: 100%;
      left: 50%;
      translate: -50% var(--lh);

      /* Arrow */
      &::after {
        border: var(--tooltip-arrow-width) solid transparent;
        border-top-color: var(--tooltip-bg);
        content: '';
        position: absolute;
        bottom: calc(-1 * var(--tooltip-arrow-width));
        left: 50%;
        translate: -50% 0;
        width: 0;
        height: 0;
      }
    }

    &:hover .tooltip-bubble,
    &:focus-visible .tooltip-bubble,
    &:active .tooltip-bubble {
      opacity: 1;
      pointer-events: auto;
      translate: -50% calc(var(--tooltip-arrow-width) * -1);
      visibility: visible;
    }
  }

  /* Bottom and side tooltips on mobile devices */
  &.tooltip-bottom,
  &.tooltip-left,
  &.tooltip-right {
    .tooltip-bubble {
      top: 100%;
      left: 50%;
      translate: -50% calc(var(--lh) * -1);

      &::after {
        border: var(--tooltip-arrow-width) solid transparent;
        border-bottom-color: var(--tooltip-bg);
        content: '';
        position: absolute;
        top: calc(-1 * var(--tooltip-arrow-width));
        left: 50%;
        translate: -50% 0;
        width: 0;
        height: 0;
      }
    }

    &:hover .tooltip-bubble,
    &:focus-visible .tooltip-bubble,
    &:active .tooltip-bubble {
      opacity: 1;
      pointer-events: auto;
      translate: -50% var(--tooltip-arrow-width);
      visibility: visible;
    }
  }

  /* Left (desktop / tablet) */
  &.tooltip-left {
    @media (--tablet) {
      .tooltip-bubble {
        top: 50%;
        left: auto;
        right: 100%;
        translate: var(--lh) -50%;

        &::after {
          border: var(--tooltip-arrow-width) solid transparent;
          border-left-color: var(--tooltip-bg);
          top: 50%;
          right: calc(-1.5 * var(--tooltip-arrow-width));
          left: auto;
          translate: 0 -50%;
        }
      }

      &:hover .tooltip-bubble,
      &:focus-visible .tooltip-bubble,
      &:active .tooltip-bubble {
        translate: calc(var(--tooltip-arrow-width) * -1) -50%;
      }
    }
  }

  /* Right (desktop / tablet) */
  &.tooltip-right {
    @media (--tablet) {
      .tooltip-bubble {
        top: 50%;
        left: 100%;
        translate: calc(var(--lh) * -1) -50%;

        &::after {
          border: var(--tooltip-arrow-width) solid transparent;
          border-right-color: var(--tooltip-bg);
          top: 50%;
          right: auto;
          left: calc(-1 * var(--tooltip-arrow-width));
          translate: 0 -50%;
        }
      }

      &:hover .tooltip-bubble,
      &:focus-visible .tooltip-bubble,
      &:active .tooltip-bubble {
        translate: var(--tooltip-arrow-width) -50%;
      }

      /* Lower a neighbor below the tooltip, same as simple variant */
      & ~ * {
        z-index: -1;
      }
    }
  }
}

